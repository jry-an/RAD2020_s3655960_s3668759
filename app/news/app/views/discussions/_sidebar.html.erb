<%# Bulma is being used below %>

<div class="column is-3 is-offset-1">

  <h3 class="title is-5 has-text-grey-light">Recent Members</h3>
  <ul class="list">
    <ul class="users">
<!--      this needs to be fixed, need to get from @users, but not working atm-->
        <table>
          <tr>
            <% @discussions.sort_by{|d| d[:last_seen_at]}[0..2].each do |d| %>
          <td>
            <%= link_to  gravatar_image_tag(d.user.email, class:'border-radius-20', size: 20, alt: d.user.username), d.user %>
              Name: <%=link_to d.user.username, d.user %>
            </td>
            <% end %>
              <tr>
                <% @discussions.sort_by{|d| d[:last_seen_at]}[3..5].each do |d| %>
                  <td>
                    <%= link_to  gravatar_image_tag(d.user.email, class:'border-radius-20', size: 20, alt: d.user.username), d.user %>
                    Name: <%=link_to d.user.username, d.user %>
                  </td>
                <% end %>
                <tr>
                  <% @discussions.sort_by{|d| d[:last_seen_at]}[6..8].each do |d| %>
                    <td>
                      <%= link_to  gravatar_image_tag(d.user.email, class:'border-radius-20', size: 20, alt: d.user.username), d.user %>
                      Name: <%=link_to d.user.username, d.user %>
                    </td>
                  <% end %>

                </tr>

              </tr>
          </tr>



        </table>
        </li>
    </ul>
  </ul>

  <br/>
  <br/>
  <br/>


  <h3 class="title is-5 has-text-grey-light">Topics</h3>

  <ul class="list">
    <% @topics.each do |t| %>
    <li><%= link_to t.topic, t %></li>
    <% end %>
  </ul>



  <br/>

  <%= link_to 'New Topic', new_topic_path, class: 'button is-info' %>

  <%# Only allow users with admin status to create new topics %>
  <%# Will be added later on %>
  
  <br/>
  <br/>
  <br/>
  <h3 class="title is-5 has-text-grey-light">Top Posts</h3>
  <ul class="list">
    <!--  This reverses the array and gets the top 5 posts-->
    <% @discussions.sort_by{|d| d[:view_count]}.reverse[0..4].each do |d| %>
      <li><%= link_to d.title, d %> <%= d.view_count %></li>
    <% end %>
  </ul>

</div>



